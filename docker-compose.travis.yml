version: "3.0"

services:   

  oracle:
    image: sath89/oracle-12c:latest
    ports:
      - "1522:1521"
      - "8081:8080"
    volumes:
      - ./script/docker/oracle/create_user.sql:/docker-entrypoint-initdb.d/create_user.sql
    healthcheck:
      test: /bin/sh -c 'echo "SELECT 12345 FROM DUAL;" | sqlplus -S -L travis/travis@localhost:1521/xe.oracle.docker | grep -wq 12345'
      interval: 2s
      timeout: 10s
      retries: 1800 # 2s*1800 = 3600s = 60min
      
  mssqlserver:
    image: microsoft/mssql-server-linux:latest
    environment:
        ACCEPT_EULA: Y
        SA_PASSWORD: P6spyTravis
    ports:
      - "1434:1433"
    healthcheck:
      test: /bin/sh -c '/opt/mssql-tools/bin/sqlcmd -S localhost -U sa -P P6spyTravis  -Q "SELECT 12345" | grep -wq 12345'
      interval: 2s
      timeout: 10s
      retries: 1800 # 2s*1800 = 3600s = 60min
